!::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
!
!    This file is part of ICTP CHyM.
!
!    ICTP CHyM is free software: you can redistribute it and/or modify
!    it under the terms of the GNU General Public License as published by
!    the Free Software Foundation, either version 3 of the License, or
!    (at your option) any later version.
!
!    ICTP CHyM is distributed in the hope that it will be useful,
!    but WITHOUT ANY WARRANTY; without even the implied warranty of
!    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
!    GNU General Public License for more details.
!
!    You should have received a copy of the GNU General Public License
!    along with ICTP CHyM.  If not, see <http://www.gnu.org/licenses/>.
!
!::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
module mod_statparams
  integer, parameter :: short=SELECTED_INT_KIND(2)
  integer, parameter :: long=SELECTED_INT_KIND(4)
  character(len=256) :: namelistfile
  integer :: iretval

  integer :: iind , lun , lun1 , mes
  integer :: i

  integer :: n2df
  integer :: n4df
  integer , parameter :: mare = 15
  integer , parameter :: lago = 14
  integer , parameter :: fiume = 100
  integer , parameter :: lntypes = 110
!
  integer :: izoom
  real :: plat1 , plat2 , plon1 , plon2
!
  character(len=60) :: actsource , mm5file , now , sdata
  integer :: idate , anno , mese , giorno , ora
  integer :: idemcor , idhour , iplot , isdate , stepxhour , tplot
  integer :: ienddate
  real :: avr , deltat , elat , elon , hmax
  character(len=132) :: scst , string
  character(len=60) , dimension(8) :: sources
!
  logical :: piove
  logical :: nnflag
  data nnflag /.true./
!
  integer :: nreg1 , nreg2
  integer :: mm5domain
!
  integer , parameter :: ixm = 100
  integer , parameter :: jxm = 100
  real , dimension(ixm,jxm,25) :: p
  real , dimension(ixm,jxm,24) :: t
  real , dimension(ixm,jxm) :: xlat , xlon

  real , dimension(52) :: cpar
!
  real , allocatable , dimension(:,:) :: accl , alfa , area , bwet , ddeepw ,   &
          deepw , dem , dh2o , drai , dx , evap , gh2o , h2o , lat , lon ,      &
          modis , port , rain , rsrm , runt , snow , temp , wk , wrk1 , wrk2 ,  &
          lavonc , allrivb
  real , allocatable , dimension(:) :: port1d, portsub1d, bwet1d, bwetsub1d, h2o1d, h2osub1d
  real , allocatable , dimension(:) :: port1d_n, portsub1d_n, bwet1d_n, bwetsub1d_n, h2o1d_n, h2osub1d_n
  real , allocatable , dimension(:) :: wrk4 , seqx , seqy
  integer , allocatable , dimension(:,:) :: ca , fmap , luse , noflow , iwk , &
          caplot , lca , canc
  integer , allocatable , dimension(:) :: iriv , jriv , seqi , seqj
  real , allocatable , dimension(:,:) :: avgrain, avgrsrm, avgport,avgbwet
  real , allocatable , dimension(:,:) :: avggh2o, avgevap, avgsnow,avgarai
  real , allocatable , dimension(:,:) :: avgtemp, avgdeepw, avgddeepw, avgh2o
  real, allocatable , dimension(:,:) :: portsub, h2osub, bwetsub, wkm1sub
  real, allocatable , dimension(:,:) :: lati,loni,rani,temi
  integer, allocatable , dimension(:,:) :: mapi,mapj
  integer, allocatable , dimension(:,:) :: demd
  real , allocatable, dimension (:,:) :: fmap1
!
! Needed by readerancll
!
  real , allocatable , dimension(:,:) :: rainiold15, rainiold75

  integer , parameter :: n1dv = 200000
  real , dimension(n1dv) :: xwk1 , xwk2 , xwk3

  integer :: ibas , jbas , nrivp , nsec , nselrp , selriver

  integer , parameter :: mxsc = 300000
  integer , dimension(mxsc) :: isec , jsec

  character(len=80) :: dfields
  character(len=80) :: sstr1 , sstr2
  integer :: logfile , lun10 , lun11 , newmm51
  integer , dimension(12) :: lu
  logical , dimension(32) :: srcflag

  real , dimension(6,3) :: abc
  integer , dimension(30) :: icod
  real , dimension(30,12) :: kc
  integer , dimension(12) :: jd , mnd
  real , dimension(lntypes,12) :: evc
  real , dimension(lntypes) :: infi , manning , perc
  integer , dimension(9) :: ir , jr
  data ir /-1, 0, 1, 1, 1, 0,-1,-1,0/
  data jr / 1, 1, 1, 0,-1,-1,-1, 0,0/
  integer , dimension(3) :: chunksizes
  character(len=80) :: dflcodes
  character(len=80), dimension(32) :: fields
  character(len=48) :: rainsrc
  data dflcodes /'rai,rsr,ara,por,wet,gwt,h2o,evp,sno,tem,dgw,ddw,alf'/
  data fields(1:8) / 'Digital Elevation Model (m)',   &
                     'Latitude (deg)',   &
                     'Longitude (deg)',   &
                     'Integer showing flow dir (1-8 from NW to W)',   &
                     'Slope (tangent of angle in the flow direction)',   &
                     'Integer for Land use code',   &
                     'Area (Km2) of each cell',   &
                     'Total Drained Area of each cell (Km2)'/
  data fields(21:32) /'Input rain (mm/h)',   &
                       'Rain Source',   &
                       'Water available for runoff (prec-inf-evap)',   &
                       'Flow discharge (m3/sec)',   &
                       'Wetted area x cell-channell lenght',   &
                       'Ground and Vegetation water content',   &
                       'Total water content',   &
                       'Change in sur. water content for curr. time step',   &
                       'Temperature (C)',   &
                       'Deep soil Water content',   &
                       'Deep soil Water contentd',  &
                       'Flow velocity' /
 data manning /lntypes*0.043/

  data (abc(1,i),i = 1,3)/ - 0.0002 , 0.0196 , 0.3802/
  data (abc(2,i),i = 1,3)/ - 0.0002 , 0.0191 , 0.4034/
  data (abc(3,i),i = 1,3)/ - 0.0002 , 0.0198 , 0.4129/
  data (abc(4,i),i = 1,3)/ - 0.0002 , 0.0171 , 0.4551/
  data (abc(5,i),i = 1,3)/ - 0.0002 , 0.0164 , 0.4883/
  data (abc(6,i),i = 1,3)/ - 0.0002 , 0.0168 , 0.5106/

  data (jd(i),i = 1,12)/15 , 46 , 74 , 105 , 135 , 166 , 196 , 227 , 258 ,  &
        288 , 319 , 349/

  data (mnd(i),i = 1,12)/31 , 28 , 31 , 30 , 31 , 30 , 31 , 31 , 30 , 31 ,  &
        30 , 31/

  data (icod(i),i = 1,15)/1 , 2 , 5 , 9 , 10 , 14 , 15 , 19 , 22 , 23 , 24 ,&
        25 , 26 , 30 , 31/
  data (icod(i),i = 16,30)/36 , 37 , 42 , 46 , 55 , 56 , 57 , 58 , 60 , 62 ,&
        63 , 91 , 93 , 94 , 100/

  data (kc(1,i),i = 1,12)/0.20 , 0.20 , 0.20 , 0.20 , 0.20 , 0.20 , 0.20 ,  &
        0.20 , 0.20 , 0.20 , 0.20 , 0.20/
  data (kc(2,i),i = 1,12)/0.60 , 0.65 , 0.70 , 0.75 , 0.80 , 0.80 , 0.85 ,  &
        0.85 , 0.85 , 0.80 , 0.80 , 0.60/
  data (kc(3,i),i = 1,12)/0.60 , 0.70 , 0.95 , 1.05 , 1.05 , 0.80 , 0.80 ,  &
        0.80 , 0.80 , 1.20 , 1.10 , 0.60/
  data (kc(4,i),i = 1,12)/0.60 , 0.65 , 0.70 , 0.75 , 0.80 , 0.80 , 0.85 ,  &
        0.85 , 0.85 , 0.80 , 0.80 , 0.60/
  data (kc(5,i),i = 1,12)/0.80 , 1.05 , 1.10 , 1.10 , 1.10 , 0.80 , 0.90 ,  &
        0.80 , 0.80 , 1.00 , 1.00 , 0.90/
  data (kc(6,i),i = 1,12)/1.05 , 1.05 , 1.05 , 1.05 , 1.05 , 1.05 , 1.05 ,  &
        1.05 , 1.05 , 1.05 , 1.05 , 1.05/
  data (kc(7,i),i = 1,12)/1.05 , 1.05 , 1.05 , 1.05 , 1.05 , 1.05 , 1.05 ,  &
        1.05 , 1.05 , 1.05 , 1.05 , 1.05/
  data (kc(8,i),i = 1,12)/0.90 , 0.90 , 0.90 , 0.90 , 0.90 , 0.90 , 0.90 ,  &
        0.90 , 0.90 , 0.90 , 0.90 , 0.90/
  data (kc(9,i),i = 1,12)/0.90 , 0.90 , 0.90 , 0.90 , 0.90 , 0.90 , 0.90 ,  &
        0.90 , 0.90 , 0.90 , 0.90 , 0.90/
  data (kc(10,i),i = 1,12)/0.75 , 1.00 , 0.90 , 0.95 , 1.20 , 0.85 , 0.85 , &
        0.85 , 0.85 , 1.05 , 1.00 , 0.75/
  data (kc(11,i),i = 1,12)/0.75 , 1.00 , 0.90 , 0.95 , 1.20 , 0.85 , 0.85 , &
        0.85 , 0.85 , 1.05 , 1.00 , 0.75/
  data (kc(12,i),i = 1,12)/0.60 , 0.70 , 0.95 , 1.05 , 1.05 , 0.80 , 0.80 , &
        0.80 , 0.80 , 1.20 , 1.10 , 0.60/
  data (kc(13,i),i = 1,12)/0.60 , 0.70 , 0.95 , 1.05 , 1.05 , 0.80 , 0.80 , &
        0.80 , 0.80 , 1.20 , 1.10 , 0.60/
  data (kc(14,i),i = 1,12)/0.60 , 0.80 , 0.90 , 0.90 , 0.95 , 0.95 , 0.95 , &
        0.90 , 0.85 , 0.80 , 0.75 , 0.70/
  data (kc(15,i),i = 1,12)/0.60 , 0.80 , 0.90 , 0.90 , 0.95 , 0.95 , 0.95 , &
        0.90 , 0.85 , 0.80 , 0.75 , 0.70/
  data (kc(16,i),i = 1,12)/0.75 , 1.00 , 1.15 , 1.20 , 1.30 , 1.20 , 1.20 , &
        1.14 , 1.14 , 1.25 , 1.20 , 0.75/
  data (kc(17,i),i = 1,12)/0.70 , 1.00 , 1.10 , 1.20 , 1.35 , 1.20 , 1.10 , &
        0.90 , 1.30 , 1.25 , 1.20 , 0.75/
  data (kc(18,i),i = 1,12)/0.80 , 1.05 , 1.10 , 1.10 , 1.10 , 0.80 , 0.90 , &
        0.80 , 0.80 , 1.00 , 1.00 , 0.90/
  data (kc(19,i),i = 1,12)/0.75 , 1.00 , 0.90 , 0.95 , 1.20 , 0.85 , 0.85 , &
        0.85 , 0.85 , 1.05 , 1.00 , 0.75/
  data (kc(20,i),i = 1,12)/0.75 , 1.00 , 0.90 , 0.95 , 1.20 , 0.85 , 0.85 , &
        0.85 , 0.85 , 1.05 , 1.00 , 0.75/
  data (kc(21,i),i = 1,12)/0.75 , 1.00 , 0.90 , 0.95 , 1.20 , 0.85 , 0.85 , &
        0.85 , 0.85 , 1.05 , 1.00 , 0.75/
  data (kc(22,i),i = 1,12)/0.75 , 1.00 , 0.90 , 0.95 , 1.20 , 0.85 , 0.85 , &
        0.85 , 0.85 , 1.05 , 1.00 , 0.75/
  data (kc(23,i),i = 1,12)/0.60 , 0.65 , 0.70 , 0.75 , 0.80 , 0.80 , 0.85 , &
        0.85 , 0.85 , 0.80 , 0.80 , 0.60/
  data (kc(24,i),i = 1,12)/0.90 , 0.90 , 0.90 , 0.90 , 0.90 , 0.90 , 0.90 , &
        0.90 , 0.90 , 0.90 , 0.90 , 0.90/
  data (kc(25,i),i = 1,12)/0.90 , 0.90 , 0.90 , 0.90 , 0.90 , 0.90 , 0.90 , &
        0.90 , 0.90 , 0.90 , 0.90 , 0.90/
  data (kc(26,i),i = 1,12)/0.60 , 0.65 , 0.70 , 0.75 , 0.80 , 0.80 , 0.85 , &
        0.85 , 0.85 , 0.80 , 0.80 , 0.60/
  data (kc(27,i),i = 1,12)/0.60 , 0.65 , 0.70 , 0.75 , 0.80 , 0.80 , 0.85 , &
        0.85 , 0.85 , 0.80 , 0.80 , 0.60/
  data (kc(28,i),i = 1,12)/0.80 , 1.05 , 1.10 , 1.10 , 1.10 , 0.80 , 0.90 , &
        0.80 , 0.80 , 1.00 , 1.00 , 0.90/
  data (kc(29,i),i = 1,12)/0.80 , 1.05 , 1.10 , 1.10 , 1.10 , 0.80 , 0.90 , &
        0.80 , 0.80 , 1.00 , 1.00 , 0.90/
  data (kc(30,i),i = 1,12)/1.05 , 1.05 , 1.05 , 1.05 , 1.05 , 1.05 , 1.05 , &
        1.05 , 1.05 , 1.05 , 1.05 , 1.05/
! data (kc(31,i),i=1,12)/1,1,1,1,1,1,1,1,1,1,1,1/
  data ir/ - 1 , 0 , 1 , 1 , 1 , 0 , -1 , -1 , 0/
  data jr/1 , 1 , 1 , 0 , -1 , -1 , -1 , 0 , 0/
  data dfields/'rai,rsr,ara,por,wet,gwt,evp,sno,tem,dgw'/
  data (manning(i),i = 1,50)/10.0 , .040 , .150 , .100 , .100 , .100 , .065 ,  &
        .030 , .030 , .080 , .030 , .030 , .080 , .035 , .036 , .080 , .080 ,  &
        .120 , .150 , .150 , .150 , .150 , .150 , .120 , .110 , .110 , .150 ,  &
        .180 , .180 , .120 , .130 , .100 , .180 , .100 , .075 , .055 , .055 ,  &
        .063 , .060 , .080 , .080 , .040 , .100 , .080 , .080 , .080 , .080 ,  &
        .100 , .030 , .030/
  data (manning(i),i = 51,lntypes)/.030 , .030 , .030 , .120 , .075 , .100 ,   &
        .100 , .080 , .080 , .080 , .100 , .100 , .150 , .075 , .080 , .080 ,  &
        .080 , .080 , .080 , .030 , .030 , .035 , .075 , .035 , .035 , .035 ,  &
        .035 , .150 , .120 , .120 , .035 , .035 , .035 , .035 , .035 , .035 ,  &
        .030 , .030 , .050 , .100 , .100 , .080 , .045 , .040 , .120 , .100 ,  &
        .043 , .043 , .043 , .043 , .043 , .043 , .043 , .043 , .043 , .043 ,  &
        .043 , .043 , .043 , .043/
  data (perc(i),i = 1,50)/0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 ,&
        0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 ,&
        0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 ,&
        0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 ,&
        0.5 , 0.5 , 0.5 , 0.5 , 0.5/
  data (perc(i),i = 51,lntypes)/0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 ,&
        0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 ,&
        0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 ,&
        0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 ,&
        0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 , 0.5 ,&
        0.5 , 0.5 , 0.5 , 0.5/
  data (infi(i),i = 1,50)/15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 ,     &
        15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 ,  &
        15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 ,  &
        15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 ,  &
        15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 ,  &
        15.0 , 15.0 , 15.0/
  data (infi(i),i = 51,lntypes)/15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 ,      &
        15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 ,  &
        15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 ,  &
        15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 ,  &
        15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 ,  &
        15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 , 15.0 ,  &
        15.0 , 15.0 , 15.0 , 15.0/
  data (evc(1,i),i = 1,12)/0.20 , 0.20 , 0.20 , 0.20 , 0.20 , 0.20 , 0.20 ,    &
        0.20 , 0.20 , 0.20 , 0.20 , 0.20/
  data (evc(2,i),i = 1,12)/0.60 , 0.65 , 0.70 , 0.75 , 0.80 , 0.80 , 0.85 ,    &
        0.85 , 0.85 , 0.80 , 0.80 , 0.60/
  data (evc(3,i),i = 1,12)/0.90 , 0.90 , 0.90 , 0.90 , 0.90 , 0.90 , 0.90 ,    &
        0.90 , 0.90 , 0.90 , 0.90 , 0.90/
  data (evc(4,i),i = 1,12)/0.90 , 0.90 , 0.90 , 0.90 , 0.90 , 0.90 , 0.90 ,    &
        0.90 , 0.90 , 0.90 , 0.90 , 0.90/
  data (evc(5,i),i = 1,12)/0.60 , 0.70 , 0.95 , 1.05 , 1.05 , 0.80 , 0.80 ,    &
        0.80 , 0.80 , 1.20 , 1.10 , 0.60/
  data (evc(6,i),i = 1,12)/0.90 , 0.90 , 0.90 , 0.90 , 0.90 , 0.90 , 0.90 ,    &
        0.90 , 0.90 , 0.90 , 0.90 , 0.90/
  data (evc(7,i),i = 1,12)/0.60 , 0.65 , 0.70 , 0.75 , 0.80 , 0.80 , 0.85 ,    &
        0.85 , 0.85 , 0.80 , 0.80 , 0.60/
  data (evc(8,i),i = 1,12)/0.60 , 0.65 , 0.70 , 0.75 , 0.80 , 0.80 , 0.85 ,    &
        0.85 , 0.85 , 0.80 , 0.80 , 0.60/
  data (evc(9,i),i = 1,12)/0.60 , 0.65 , 0.70 , 0.75 , 0.80 , 0.80 , 0.85 ,    &
        0.85 , 0.85 , 0.80 , 0.80 , 0.60/
  data (evc(10,i),i = 1,12)/0.80 , 1.05 , 1.10 , 1.10 , 1.10 , 0.80 , 0.90 ,   &
        0.80 , 0.80 , 1.00 , 1.00 , 0.90/
  data (evc(11,i),i = 1,12)/0.65 , 0.65 , 0.75 , 0.80 , 0.90 , 0.80 , 0.70 ,   &
        0.70 , 0.70 , 0.70 , 0.70 , 0.65/
  data (evc(12,i),i = 1,12)/1.05 , 1.05 , 1.05 , 1.05 , 1.05 , 1.05 , 1.05 ,   &
        1.05 , 1.05 , 1.05 , 1.05 , 1.05/
  data (evc(13,i),i = 1,12)/1.05 , 1.05 , 1.05 , 1.05 , 1.05 , 1.05 , 1.05 ,   &
        1.05 , 1.05 , 1.05 , 1.05 , 1.05/
  data (evc(14,i),i = 1,12)/1.05 , 1.05 , 1.05 , 1.05 , 1.05 , 1.05 , 1.05 ,   &
        1.05 , 1.05 , 1.05 , 1.05 , 1.05/
  data (evc(15,i),i = 1,12)/1.05 , 1.05 , 1.05 , 1.05 , 1.05 , 1.05 , 1.05 ,   &
        1.05 , 1.05 , 1.05 , 1.05 , 1.05/
  data (evc(16,i),i = 1,12)/0.60 , 0.65 , 0.70 , 0.75 , 0.80 , 0.80 , 0.85 ,   &
        0.85 , 0.85 , 0.80 , 0.80 , 0.60/
  data (evc(17,i),i = 1,12)/0.60 , 0.65 , 0.70 , 0.75 , 0.80 , 0.80 , 0.85 ,   &
        0.85 , 0.85 , 0.80 , 0.80 , 0.60/
  data (evc(18,i),i = 1,12)/0.75 , 1.00 , 1.15 , 1.20 , 1.30 , 1.20 , 1.20 ,   &
        1.14 , 1.14 , 1.25 , 1.20 , 0.75/
  data (evc(19,i),i = 1,12)/0.90 , 0.90 , 0.90 , 0.90 , 0.90 , 0.90 , 0.90 ,   &
        0.90 , 0.90 , 0.90 , 0.90 , 0.90/
  data (evc(20,i),i = 1,12)/0.75 , 1.00 , 0.90 , 0.95 , 1.20 , 0.85 , 0.85 ,   &
        0.85 , 0.85 , 1.05 , 1.00 , 0.75/
  data (evc(21,i),i = 1,12)/0.90 , 0.90 , 0.90 , 0.90 , 0.90 , 0.90 , 0.90 ,   &
        0.90 , 0.90 , 0.90 , 0.90 , 0.90/
  data (evc(22,i),i = 1,12)/0.90 , 0.90 , 0.90 , 0.90 , 0.90 , 0.90 , 0.90 ,   &
        0.90 , 0.90 , 0.90 , 0.90 , 0.90/
  data (evc(23,i),i = 1,12)/0.75 , 1.00 , 0.90 , 0.95 , 1.20 , 0.85 , 0.85 ,   &
        0.85 , 0.85 , 1.05 , 1.00 , 0.75/
  data (evc(24,i),i = 1,12)/0.75 , 1.00 , 0.90 , 0.95 , 1.20 , 0.85 , 0.85 ,   &
        0.85 , 0.85 , 1.05 , 1.00 , 0.75/
  data (evc(25,i),i = 1,12)/0.60 , 0.70 , 0.95 , 1.05 , 1.05 , 0.80 , 0.80 ,   &
        0.80 , 0.80 , 1.20 , 1.10 , 0.60/
  data (evc(26,i),i = 1,12)/0.60 , 0.70 , 0.95 , 1.05 , 1.05 , 0.80 , 0.80 ,   &
        0.80 , 0.80 , 1.20 , 1.10 , 0.60/
  data (evc(27,i),i = 1,12)/0.90 , 0.90 , 0.90 , 0.90 , 0.90 , 0.90 , 0.90 ,   &
        0.90 , 0.90 , 0.90 , 0.90 , 0.90/
  data (evc(28,i),i = 1,12)/0.90 , 0.90 , 0.90 , 0.90 , 0.90 , 0.90 , 0.90 ,   &
        0.90 , 0.90 , 0.90 , 0.90 , 0.90/
  data (evc(29,i),i = 1,12)/0.75 , 1.00 , 0.90 , 0.95 , 1.20 , 0.85 , 0.85 ,   &
        0.85 , 0.85 , 1.05 , 1.00 , 0.75/
  data (evc(30,i),i = 1,12)/0.60 , 0.80 , 0.90 , 0.90 , 0.95 , 0.95 , 0.95 ,   &
        0.90 , 0.85 , 0.80 , 0.75 , 0.70/
  data (evc(31,i),i = 1,12)/0.60 , 0.80 , 0.90 , 0.90 , 0.95 , 0.95 , 0.95 ,   &
        0.90 , 0.85 , 0.80 , 0.75 , 0.70/
  data (evc(32,i),i = 1,12)/0.75 , 1.00 , 0.90 , 0.95 , 1.20 , 0.85 , 0.85 ,   &
        0.85 , 0.85 , 1.05 , 1.00 , 0.75/
  data (evc(33,i),i = 1,12)/0.75 , 1.00 , 0.90 , 0.95 , 1.20 , 0.85 , 0.85 ,   &
        0.85 , 0.85 , 1.05 , 1.00 , 0.75/
  data (evc(34,i),i = 1,12)/0.75 , 1.00 , 0.90 , 0.95 , 1.20 , 0.85 , 0.85 ,   &
        0.85 , 0.85 , 1.05 , 1.00 , 0.75/
  data (evc(35,i),i = 1,12)/0.75 , 1.00 , 1.15 , 1.20 , 1.30 , 1.20 , 1.20 ,   &
        1.14 , 1.14 , 1.25 , 1.20 , 0.75/
  data (evc(36,i),i = 1,12)/0.75 , 1.00 , 1.15 , 1.20 , 1.30 , 1.20 , 1.20 ,   &
        1.14 , 1.14 , 1.25 , 1.20 , 0.75/
  data (evc(37,i),i = 1,12)/0.70 , 1.00 , 1.10 , 1.20 , 1.35 , 1.20 , 1.10 ,   &
        0.90 , 1.30 , 1.25 , 1.20 , 0.75/
  data (evc(38,i),i = 1,12)/0.75 , 1.00 , 1.15 , 1.20 , 1.30 , 1.20 , 1.20 ,   &
        1.14 , 1.14 , 1.25 , 1.20 , 0.75/
  data (evc(39,i),i = 1,12)/0.75 , 1.00 , 1.15 , 1.20 , 1.30 , 1.20 , 1.20 ,   &
        1.14 , 1.14 , 1.25 , 1.20 , 0.75/
  data (evc(40,i),i = 1,12)/0.80 , 1.05 , 1.10 , 1.10 , 1.10 , 0.80 , 0.90 ,   &
        0.80 , 0.80 , 1.00 , 1.00 , 0.90/
  data (evc(41,i),i = 1,12)/0.80 , 1.05 , 1.10 , 1.10 , 1.10 , 0.80 , 0.90 ,   &
        0.80 , 0.80 , 1.00 , 1.00 , 0.90/
  data (evc(42,i),i = 1,12)/0.80 , 1.05 , 1.10 , 1.10 , 1.10 , 0.80 , 0.90 ,   &
        0.80 , 0.80 , 1.00 , 1.00 , 0.90/
  data (evc(43,i),i = 1,12)/0.60 , 0.65 , 0.70 , 0.75 , 0.80 , 0.80 , 0.85 ,   &
        0.85 , 0.85 , 0.80 , 0.80 , 0.60/
  data (evc(44,i),i = 1,12)/1.05 , 1.05 , 1.05 , 1.05 , 1.05 , 1.05 , 1.05 ,   &
        1.05 , 1.05 , 1.05 , 1.05 , 1.05/
  data (evc(45,i),i = 1,12)/1.05 , 1.05 , 1.05 , 1.05 , 1.05 , 1.05 , 1.05 ,   &
        1.05 , 1.05 , 1.05 , 1.05 , 1.05/
  data (evc(46,i),i = 1,12)/0.75 , 1.00 , 0.90 , 0.95 , 1.20 , 0.85 , 0.85 ,   &
        0.85 , 0.85 , 1.05 , 1.00 , 0.75/
  data (evc(47,i),i = 1,12)/0.75 , 1.00 , 0.90 , 0.95 , 1.20 , 0.85 , 0.85 ,   &
        0.85 , 0.85 , 1.05 , 1.00 , 0.75/
  data (evc(48,i),i = 1,12)/0.60 , 0.70 , 0.95 , 1.05 , 1.05 , 0.80 , 0.80 ,   &
        0.80 , 0.80 , 1.20 , 1.10 , 0.60/
  data (evc(49,i),i = 1,12)/0.20 , 0.20 , 0.20 , 0.20 , 0.20 , 0.20 , 0.20 ,   &
        0.20 , 0.20 , 0.20 , 0.20 , 0.20/
  data (evc(50,i),i = 1,12)/0.65 , 0.65 , 0.75 , 0.80 , 0.90 , 0.80 , 0.70 ,   &
        0.70 , 0.70 , 0.70 , 0.70 , 0.65/
  data (evc(51,i),i = 1,12)/0.60 , 0.65 , 0.70 , 0.75 , 0.80 , 0.80 , 0.85 ,   &
        0.85 , 0.85 , 0.80 , 0.80 , 0.60/
  data (evc(52,i),i = 1,12)/0.60 , 0.65 , 0.70 , 0.75 , 0.80 , 0.80 , 0.85 ,   &
        0.85 , 0.85 , 0.80 , 0.80 , 0.60/
  data (evc(53,i),i = 1,12)/0.65 , 0.65 , 0.75 , 0.80 , 0.90 , 0.80 , 0.70 ,   &
        0.70 , 0.70 , 0.70 , 0.70 , 0.65/
  data (evc(54,i),i = 1,12)/0.75 , 1.00 , 0.90 , 0.95 , 1.20 , 0.85 , 0.85 ,   &
        0.85 , 0.85 , 1.05 , 1.00 , 0.75/
  data (evc(55,i),i = 1,12)/0.75 , 1.00 , 0.90 , 0.95 , 1.20 , 0.85 , 0.85 ,   &
        0.85 , 0.85 , 1.05 , 1.00 , 0.75/
  data (evc(56,i),i = 1,12)/0.75 , 1.00 , 0.90 , 0.95 , 1.20 , 0.85 , 0.85 ,   &
        0.85 , 0.85 , 1.05 , 1.00 , 0.75/
  data (evc(57,i),i = 1,12)/0.75 , 1.00 , 0.90 , 0.95 , 1.20 , 0.85 , 0.85 ,   &
        0.85 , 0.85 , 1.05 , 1.00 , 0.75/
  data (evc(58,i),i = 1,12)/0.60 , 0.65 , 0.70 , 0.75 , 0.80 , 0.80 , 0.85 ,   &
        0.85 , 0.85 , 0.80 , 0.80 , 0.60/
  data (evc(59,i),i = 1,12)/0.75 , 1.00 , 1.15 , 1.20 , 1.30 , 1.20 , 1.20 ,   &
        1.14 , 1.14 , 1.25 , 1.20 , 0.75/
  data (evc(60,i),i = 1,12)/0.90 , 0.90 , 0.90 , 0.90 , 0.90 , 0.90 , 0.90 ,   &
        0.90 , 0.90 , 0.90 , 0.90 , 0.90/
  data (evc(61,i),i = 1,12)/0.60 , 0.70 , 0.95 , 1.05 , 1.05 , 0.80 , 0.80 ,   &
        0.80 , 0.80 , 1.20 , 1.10 , 0.60/
  data (evc(62,i),i = 1,12)/0.90 , 0.90 , 0.90 , 0.90 , 0.90 , 0.90 , 0.90 ,   &
        0.90 , 0.90 , 0.90 , 0.90 , 0.90/
  data (evc(63,i),i = 1,12)/0.60 , 0.65 , 0.70 , 0.75 , 0.80 , 0.80 , 0.85 ,   &
        0.85 , 0.85 , 0.80 , 0.80 , 0.60/
  data (evc(64,i),i = 1,12)/0.60 , 0.65 , 0.70 , 0.75 , 0.80 , 0.80 , 0.85 ,   &
        0.85 , 0.85 , 0.80 , 0.80 , 0.60/
  data (evc(65,i),i = 1,12)/1.05 , 1.05 , 1.05 , 1.05 , 1.05 , 1.05 , 1.05 ,   &
        1.05 , 1.05 , 1.05 , 1.05 , 1.05/
  data (evc(66,i),i = 1,12)/1.05 , 1.05 , 1.05 , 1.05 , 1.05 , 1.05 , 1.05 ,   &
        1.05 , 1.05 , 1.05 , 1.05 , 1.05/
  data (evc(67,i),i = 1,12)/1.05 , 1.05 , 1.05 , 1.05 , 1.05 , 1.05 , 1.05 ,   &
        1.05 , 1.05 , 1.05 , 1.05 , 1.05/
  data (evc(68,i),i = 1,12)/1.05 , 1.05 , 1.05 , 1.05 , 1.05 , 1.05 , 1.05 ,   &
        1.05 , 1.05 , 1.05 , 1.05 , 1.05/
  data (evc(69,i),i = 1,12)/0.60 , 0.65 , 0.70 , 0.75 , 0.80 , 0.80 , 0.85 ,   &
        0.85 , 0.85 , 0.80 , 0.80 , 0.60/
  data (evc(70,i),i = 1,12)/0.20 , 0.20 , 0.20 , 0.20 , 0.20 , 0.20 , 0.20 ,   &
        0.20 , 0.20 , 0.20 , 0.20 , 0.20/
  data (evc(71,i),i = 1,12)/0.65 , 0.65 , 0.75 , 0.80 , 0.90 , 0.80 , 0.70 ,   &
        0.70 , 0.70 , 0.70 , 0.70 , 0.65/
  data (evc(72,i),i = 1,12)/1.05 , 1.05 , 1.05 , 1.05 , 1.05 , 1.05 , 1.05 ,   &
        1.05 , 1.05 , 1.05 , 1.05 , 1.05/
  data (evc(73,i),i = 1,12)/1.05 , 1.05 , 1.05 , 1.05 , 1.05 , 1.05 , 1.05 ,   &
        1.05 , 1.05 , 1.05 , 1.05 , 1.05/
  data (evc(74,i),i = 1,12)/1.05 , 1.05 , 1.05 , 1.05 , 1.05 , 1.05 , 1.05 ,   &
        1.05 , 1.05 , 1.05 , 1.05 , 1.05/
  data (evc(75,i),i = 1,12)/1.05 , 1.05 , 1.05 , 1.05 , 1.05 , 1.05 , 1.05 ,   &
        1.05 , 1.05 , 1.05 , 1.05 , 1.05/
  data (evc(76,i),i = 1,12)/0.75 , 1.00 , 1.15 , 1.20 , 1.30 , 1.20 , 1.20 ,   &
        1.14 , 1.14 , 1.25 , 1.20 , 0.75/
  data (evc(77,i),i = 1,12)/0.90 , 0.90 , 0.90 , 0.90 , 0.90 , 0.90 , 0.90 ,   &
        0.90 , 0.90 , 0.90 , 0.90 , 0.90/
  data (evc(78,i),i = 1,12)/0.75 , 1.00 , 0.90 , 0.95 , 1.20 , 0.85 , 0.85 ,   &
        0.85 , 0.85 , 1.05 , 1.00 , 0.75/
  data (evc(79,i),i = 1,12)/0.75 , 1.00 , 0.90 , 0.95 , 1.20 , 0.85 , 0.85 ,   &
        0.85 , 0.85 , 1.05 , 1.00 , 0.75/
  data (evc(80,i),i = 1,12)/1.05 , 1.05 , 1.05 , 1.05 , 1.05 , 1.05 , 1.05 ,   &
        1.05 , 1.05 , 1.05 , 1.05 , 1.05/
  data (evc(81,i),i = 1,12)/0.65 , 0.65 , 0.75 , 0.80 , 0.90 , 0.80 , 0.70 ,   &
        0.70 , 0.70 , 0.70 , 0.70 , 0.65/
  data (evc(82,i),i = 1,12)/0.65 , 0.65 , 0.75 , 0.80 , 0.90 , 0.80 , 0.70 ,   &
        0.70 , 0.70 , 0.70 , 0.70 , 0.65/
  data (evc(83,i),i = 1,12)/0.65 , 0.65 , 0.75 , 0.80 , 0.90 , 0.80 , 0.70 ,   &
        0.70 , 0.70 , 0.70 , 0.70 , 0.65/
  data (evc(84,i),i = 1,12)/0.65 , 0.65 , 0.75 , 0.80 , 0.90 , 0.80 , 0.70 ,   &
        0.70 , 0.70 , 0.70 , 0.70 , 0.65/
  data (evc(85,i),i = 1,12)/1.05 , 1.05 , 1.05 , 1.05 , 1.05 , 1.05 , 1.05 ,   &
        1.05 , 1.05 , 1.05 , 1.05 , 1.05/
  data (evc(86,i),i = 1,12)/0.20 , 0.20 , 0.20 , 0.20 , 0.20 , 0.20 , 0.20 ,   &
        0.20 , 0.20 , 0.20 , 0.20 , 0.20/
  data (evc(87,i),i = 1,12)/0.80 , 1.05 , 1.10 , 1.10 , 1.10 , 0.80 , 0.90 ,   &
        0.80 , 0.80 , 1.00 , 1.00 , 0.90/
  data (evc(88,i),i = 1,12)/0.70 , 1.00 , 1.10 , 1.20 , 1.35 , 1.20 , 1.10 ,   &
        0.90 , 1.30 , 1.25 , 1.20 , 0.75/
  data (evc(89,i),i = 1,12)/0.70 , 1.00 , 1.10 , 1.20 , 1.35 , 1.20 , 1.10 ,   &
        0.90 , 1.30 , 1.25 , 1.20 , 0.75/
  data (evc(90,i),i = 1,12)/0.60 , 0.65 , 0.70 , 0.75 , 0.80 , 0.80 , 0.85 ,   &
        0.85 , 0.85 , 0.80 , 0.80 , 0.60/
  data (evc(91,i),i = 1,12)/0.60 , 0.65 , 0.70 , 0.75 , 0.80 , 0.80 , 0.85 ,   &
        0.85 , 0.85 , 0.80 , 0.80 , 0.60/
  data (evc(92,i),i = 1,12)/0.60 , 0.70 , 0.95 , 1.05 , 1.05 , 0.80 , 0.80 ,   &
        0.80 , 0.80 , 1.20 , 1.10 , 0.60/
  data (evc(93,i),i = 1,12)/0.80 , 1.05 , 1.10 , 1.10 , 1.10 , 0.80 , 0.90 ,   &
        0.80 , 0.80 , 1.00 , 1.00 , 0.90/
  data (evc(94,i),i = 1,12)/0.80 , 1.05 , 1.10 , 1.10 , 1.10 , 0.80 , 0.90 ,   &
        0.80 , 0.80 , 1.00 , 1.00 , 0.90/
  data (evc(95,i),i = 1,12)/0.60 , 0.70 , 0.95 , 1.05 , 1.05 , 0.80 , 0.80 ,   &
        0.80 , 0.80 , 1.20 , 1.10 , 0.60/
  data (evc(96,i),i = 1,12)/0.75 , 1.00 , 0.90 , 0.95 , 1.20 , 0.85 , 0.85 ,   &
        0.85 , 0.85 , 1.05 , 1.00 , 0.75/
  data (evc(97,i),i = 1,12)/1.00 , 1.00 , 1.00 , 1.00 , 1.00 , 1.00 , 1.00 ,   &
        1.00 , 1.00 , 1.00 , 1.00 , 1.00/
  data (evc(98,i),i = 1,12)/1.00 , 1.00 , 1.00 , 1.00 , 1.00 , 1.00 , 1.00 ,   &
        1.00 , 1.00 , 1.00 , 1.00 , 1.00/
  data (evc(99,i),i = 1,12)/1.00 , 1.00 , 1.00 , 1.00 , 1.00 , 1.00 , 1.00 ,   &
        1.00 , 1.00 , 1.00 , 1.00 , 1.00/
  data (evc(100,i),i = 1,12)/1.05 , 1.05 , 1.05 , 1.05 , 1.05 , 1.05 , 1.05 ,  &
        1.05 , 1.05 , 1.05 , 1.05 , 1.05/
  data srcflag/32*.false./
  data nreg1 , nreg2/0 , 0/
  data sources /8*' '/
  real :: tcressi, tcressf, tcresst
  real :: tautoi, tautof, tautot
  real :: regcm_res
  real :: add_offset_por,scale_factor_por
  real :: threshdr
  integer :: numrivdr , numrunave , uphill
!  real, allocatable, dimension(:) :: la,lo,pi,pi2val


end module mod_statparams
